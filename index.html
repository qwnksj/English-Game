<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>英语单词记忆游戏 - 网页版</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- 标题区 -->
        <header class="main-header">
            <div class="header-content">
                <h1><i class="fas fa-gamepad"></i> 英语单词记忆游戏</h1>
                <p class="subtitle">安徽专升本专用 - 网页版</p>
                <div class="current-bank">
                    <span id="currentBankDisplay">当前词库: 我的词库 (3500词)</span>
                    <span id="wordCountDisplay">单词数: 3500</span>
                </div>
            </div>
        </header>

        <main class="main-content">
            <!-- 词库选择区 -->
            <section class="card">
                <h2><i class="fas fa-book"></i> 选择学习词库</h2>
                <div class="bank-selection">
                    <div class="bank-grid">
                        <div class="bank-card active" data-bank="words.txt" onclick="selectBank('words.txt')">
                            <div class="bank-icon">
                                <i class="fas fa-book-open"></i>
                            </div>
                            <div class="bank-info">
                                <h3>我的词库 (3500词)</h3>
                                <p>专升本核心词汇</p>
                            </div>
                        </div>

                        <div class="bank-card" data-bank="words_basic.txt" onclick="selectBank('words_basic.txt')">
                            <div class="bank-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="bank-info">
                                <h3>基础词汇</h3>
                                <p>入门级别单词</p>
                            </div>
                        </div>

                        <div class="bank-card" data-bank="words_intermediate.txt" onclick="selectBank('words_intermediate.txt')">
                            <div class="bank-icon">
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                            <div class="bank-info">
                                <h3>中级词汇</h3>
                                <p>进阶学习单词</p>
                            </div>
                        </div>

                        <div class="bank-card" data-bank="words_advanced.txt" onclick="selectBank('words_advanced.txt')">
                            <div class="bank-icon">
                                <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                            </div>
                            <div class="bank-info">
                                <h3>高级词汇</h3>
                                <p>高水平单词</p>
                            </div>
                        </div>

                        <div class="bank-card" data-bank="words_exam.txt" onclick="selectBank('words_exam.txt')">
                            <div class="bank-icon">
                                <i class="fas fa-pencil-alt"></i>
                            </div>
                            <div class="bank-info">
                                <h3>考试重点</h3>
                                <p>考试高频词汇</p>
                            </div>
                        </div>

                        <div class="bank-card" data-bank="words_custom.txt" onclick="selectBank('words_custom.txt')">
                            <div class="bank-icon">
                                <i class="fas fa-edit"></i>
                            </div>
                            <div class="bank-info">
                                <h3>自定义库</h3>
                                <p>自定义单词列表</p>
                            </div>
                        </div>

                        <div class="bank-card" data-bank="all" onclick="selectBank('all')">
                            <div class="bank-icon">
                                <i class="fas fa-layer-group"></i>
                            </div>
                            <div class="bank-info">
                                <h3>全部词汇</h3>
                                <p>所有词库合集</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 游戏模式区 -->
            <section class="card">
                <h2><i class="fas fa-gamepad"></i> 游戏模式</h2>
                <div class="game-grid">
                    <div class="game-card primary" onclick="startRandomTest()">
                        <div class="game-icon">
                            <i class="fas fa-random"></i>
                        </div>
                        <h3>完全随机测试</h3>
                        <p>从词库中随机抽取单词进行测试</p>
                        <p class="game-tip">适合全面复习</p>
                    </div>

                    <div class="game-card success" onclick="showCustomPractice()">
                        <div class="game-icon">
                            <i class="fas fa-sliders-h"></i>
                        </div>
                        <h3>自定义练习</h3>
                        <p>自定义单词数量、难度和选项</p>
                        <p class="game-tip">个性化学习</p>
                    </div>

                    <div class="game-card warning" onclick="reviewWrongWords()">
                        <div class="game-icon">
                            <i class="fas fa-redo-alt"></i>
                        </div>
                        <h3>复习错题</h3>
                        <p>重点复习答错的单词</p>
                        <p class="game-tip">强化薄弱环节</p>
                    </div>

                    <div class="game-card danger" onclick="reviewByUnit()">
                        <div class="game-icon">
                            <i class="fas fa-columns"></i>
                        </div>
                        <h3>单元复习</h3>
                        <p>按单元分组复习单词</p>
                        <p class="game-tip">系统化学习</p>
                    </div>
                </div>
            </section>

            <!-- 学习工具区 -->
            <section class="card">
                <h2><i class="fas fa-tools"></i> 学习工具</h2>
                <div class="tools-grid">
                    <button class="tool-btn success" onclick="showRecords()">
                        <i class="fas fa-history"></i> 查看记录
                    </button>
                    <button class="tool-btn" onclick="showStatistics()">
                        <i class="fas fa-chart-bar"></i> 学习统计
                    </button>
                    <button class="tool-btn warning" onclick="showWordStats()">
                        <i class="fas fa-chart-pie"></i> 单词统计
                    </button>
                    <button class="tool-btn danger" onclick="manageWordBanks()">
                        <i class="fas fa-database"></i> 词库管理
                    </button>
                </div>
            </section>

            <!-- 学习进度 -->
            <section class="card">
                <h2><i class="fas fa-chart-line"></i> 学习进度</h2>
                <div class="progress-info">
                    <div>学习进度: <span id="progressText">0/3500 (0%)</span></div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-stats">
                        <div class="stat-item">
                            <span class="stat-label">已学习</span>
                            <span class="stat-value" id="studiedCount">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">正确率</span>
                            <span class="stat-value" id="accuracyRate">0%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">连续天数</span>
                            <span class="stat-value" id="streakDays">0</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- 底部操作栏 -->
        <footer class="footer">
            <div class="footer-buttons">
                <button class="btn btn-secondary" onclick="showSettings()">
                    <i class="fas fa-cog"></i> 设置
                </button>
                <button class="btn btn-primary" onclick="startQuickTest()">
                    <i class="fas fa-play"></i> 快速测试
                </button>
                <button class="btn btn-danger" onclick="quitGame()">
                    <i class="fas fa-sign-out-alt"></i> 退出
                </button>
            </div>
            <p class="copyright">© 2024 英语单词记忆游戏 | 网页版 v1.0</p>
        </footer>
    </div>

    <!-- 游戏设置模态框 -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <h2><i class="fas fa-cog"></i> 游戏设置</h2>
            <div class="setting-item">
                <label>自动跳转延迟（秒）</label>
                <input type="range" id="autoDelay" min="0.5" max="3" step="0.1" value="1.5">
                <span id="delayValue">1.5秒</span>
            </div>
            <div class="setting-item">
                <label>
                    <input type="checkbox" id="soundEffects" checked>
                    启用音效
                </label>
            </div>
            <div class="setting-item">
                <label>
                    <input type="checkbox" id="showHints" checked>
                    显示提示
                </label>
            </div>
            <div class="setting-item">
                <label>
                    <input type="checkbox" id="difficultyAdjust" checked>
                    动态调整难度
                </label>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="saveSettings()">保存设置</button>
                <button class="btn btn-secondary" onclick="closeModal('settingsModal')">取消</button>
            </div>
        </div>
    </div>

    <!-- 脚本引用 -->
    <script src="data.js"></script>
    <script src="game.js"></script>
    <script>
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化数据
            if (typeof dataManager !== 'undefined') {
                dataManager.init();
            }
            
            // 初始化游戏
            if (typeof wordGame !== 'undefined') {
                wordGame.init();
            }
            
            // 更新界面
            updateUI();
            
            // 设置事件监听
            setupEventListeners();
        });

        // 更新界面
        function updateUI() {
            updateProgress();
            updateBankInfo();
        }

        // 更新进度
        function updateProgress() {
            const progress = dataManager.getProgress();
            document.getElementById('progressText').textContent = 
                `${progress.studied}/${progress.total} (${progress.percentage}%)`;
            document.getElementById('progressFill').style.width = `${progress.percentage}%`;
            
            document.getElementById('studiedCount').textContent = progress.studied;
            document.getElementById('accuracyRate').textContent = progress.accuracy + '%';
            document.getElementById('streakDays').textContent = progress.streak;
        }

        // 更新词库信息
        function updateBankInfo() {
            const currentBank = dataManager.getCurrentBank();
            document.getElementById('currentBankDisplay').textContent = 
                `当前词库: ${currentBank.name}`;
            document.getElementById('wordCountDisplay').textContent = 
                `单词数: ${currentBank.count}`;
        }

        // 选择词库
        function selectBank(bankFile) {
            // 更新选中状态
            document.querySelectorAll('.bank-card').forEach(card => {
                card.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            // 保存选择
            dataManager.setCurrentBank(bankFile);
            updateBankInfo();
        }

        // 游戏功能
        function startRandomTest() {
            wordGame.startRandomTest(20);
        }

        function showCustomPractice() {
            const count = prompt('请输入测试单词数量 (10-100):', '20');
            if (count && count >= 10 && count <= 100) {
                wordGame.startRandomTest(parseInt(count));
            }
        }

        function reviewWrongWords() {
            wordGame.reviewWrongWords();
        }

        function reviewByUnit() {
            const unit = prompt('请输入单元编号 (1-10):', '1');
            if (unit && unit >= 1 && unit <= 10) {
                wordGame.reviewByUnit(parseInt(unit));
            }
        }

        function showRecords() {
            wordGame.showRecords();
        }

        function showStatistics() {
            wordGame.showStatistics();
        }

        function showWordStats() {
            wordGame.showWordStats();
        }

        function manageWordBanks() {
            window.open('converter.html', '_blank');
        }

        function startQuickTest() {
            wordGame.startRandomTest(10);
        }

        // 设置相关
        function showSettings() {
            document.getElementById('settingsModal').style.display = 'block';
            loadSettings();
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function loadSettings() {
            const config = dataManager.getConfig();
            document.getElementById('autoDelay').value = config.autoDelay;
            document.getElementById('delayValue').textContent = config.autoDelay + '秒';
            document.getElementById('soundEffects').checked = config.soundEffects;
            document.getElementById('showHints').checked = config.showHints;
            document.getElementById('difficultyAdjust').checked = config.difficultyAdjust;
        }

        function saveSettings() {
            const config = {
                autoDelay: parseFloat(document.getElementById('autoDelay').value),
                soundEffects: document.getElementById('soundEffects').checked,
                showHints: document.getElementById('showHints').checked,
                difficultyAdjust: document.getElementById('difficultyAdjust').checked
            };
            
            dataManager.saveConfig(config);
            alert('设置已保存！');
            closeModal('settingsModal');
        }

        function quitGame() {
            if (confirm('确定要退出游戏吗？\n您的学习进度会自动保存。')) {
                dataManager.saveAll();
                alert('感谢使用英语单词记忆游戏！\n祝您学习进步，考试顺利！');
            }
        }

        // 事件监听
        function setupEventListeners() {
            // 设置滑块
            const delaySlider = document.getElementById('autoDelay');
            const delayValue = document.getElementById('delayValue');
            if (delaySlider && delayValue) {
                delaySlider.addEventListener('input', function() {
                    delayValue.textContent = this.value + '秒';
                });
            }
            
            // 点击外部关闭模态框
            window.onclick = function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.style.display = 'none';
                }
            }
        }
    </script>
</body>
</html>